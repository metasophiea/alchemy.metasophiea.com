<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/120a5a1920781bd0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/icon.png"/><link rel="preload" as="image" href="/burger-menu.svg"/><link rel="preload" as="image" href="/four_colour_stripes_banner.png"/><link rel="stylesheet" href="/_next/static/css/b207df9cce6f5d60.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/518ba64fc6b7f185.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-beb2beff28c45430.js"/><script src="/_next/static/chunks/1347409b-5cbdd9a6015a8a75.js" async=""></script><script src="/_next/static/chunks/1914-46939293f0dc903a.js" async=""></script><script src="/_next/static/chunks/main-app-132a974eaff95eac.js" async=""></script><script src="/_next/static/chunks/5555-7fa0558dbec5c878.js" async=""></script><script src="/_next/static/chunks/app/guide/developer/tutorials/article/how-to-make-a-unit/2/page-79e23c5a0efa9469.js" async=""></script><script src="/_next/static/chunks/app/guide/developer/page-8d425e553306cf8c.js" async=""></script><script src="/_next/static/chunks/app/layout-cb24b2dc0288066b.js" async=""></script><title>Alchemy</title><meta name="description" content="A Virtual Studio"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_c0d5fb"><div class="style_main__l8Il9"><div><div class="style_desktop__CvcZU"><div class="style_main__JqgJs"><div class="style_logo___Nv4Y"><a class="style_logoLink__8L3yx" href="/"><img src="/icon.png" class="style_logoImage__PktfC"/></a></div><div class="style_links__h4_vb"><div class="style_linkAndSub__7qTZ1"><a class="style_link__4XuJC" href="/news">News</a></div><div class="style_linkAndSub__7qTZ1"><a class="style_link__4XuJC" href="/guide">Guide</a><div class="style_sub__vF1DF"><div class="style_linkAndSub__7qTZ1"><a class="style_link__4XuJC" href="/guide/getting-started">Getting Started</a></div><div class="style_linkAndSub__7qTZ1"><a class="style_link__4XuJC" href="/guide/units">Units</a></div><div class="style_linkAndSub__7qTZ1"><a class="style_link__4XuJC" href="/guide/developer">Developer</a></div></div></div><a class="style_download__caECe" href="/download">Download</a></div></div></div><div class="style_mobile__mRKt2"><div class="style_main__JqgJs style_main__Q562K"><div class="style_logo___Nv4Y"><a class="style_logoLink__8L3yx" href="/"><img src="/icon.png" class="style_logoImage__PktfC"/></a></div><div><img class="style_menuButtonImage__jSbvp" src="/burger-menu.svg"/></div></div></div><main><div class="style_main__c51pI"><div class="style_main__F_177"><a class="style_link__eozNW" aria-disabled="false" href="/">home</a><p class="style_divider__YWHjs">/</p><a class="style_link__eozNW" aria-disabled="false" href="/guide">guide</a><p class="style_divider__YWHjs">/</p><a class="style_link__eozNW" aria-disabled="false" href="/guide/developer">developer</a><p class="style_divider__YWHjs">/</p><a class="style_link__eozNW" aria-disabled="false" href="/guide/developer/tutorials">tutorials</a><p class="style_divider__YWHjs">/</p><a class="style_link__eozNW" aria-disabled="true" tabindex="-1" href="/guide/developer/tutorials/article/how-to-make-a-unit/2">How To Make A Unit - Part 2</a></div><div class="style_content__rQ3D1"><h1 class="style_title__QJpJn">How To Make A Unit - Part 2</h1><h2 class="style_subTitle___R0E7">Light And Switch - Import / Export</h2><img src="/four_colour_stripes_banner.png" class="style_headerImage__jM6kU"/><div class="style_childrenWrapper__Nt54u"><div class="style_main__L8yyS"><h3 class="style_title__oTWxy">Note</h3><div class="style_children__6YSiK"><p>This article is part of a series. If you haven&#x27;t completed part one, we recommend you do so before continuing with this one.</p></div></div><p>We&#x27;re going to use the unit you created in the previous chapter and modify it to have the Import / Export functionality.</p><h2>How Does Import / Export Work</h2><p>At some point during the program a user might decide to copy-and-paste your unit. We therefore want some way to clone a unit so that the pasted one is exactly the same as the copied one. A lot of this process is already handled by Alchemy, but the internal configuration is left up to the designer of the unit to handle. This is where the &quot;Import/Export&quot; interface comes in.</p><p>During the process of copying a unit, Alchemy will collect all relevant information (unit type, position, connections, etc.) and also collect the unit&#x27;s &quot;exportable&quot; data. &quot;exportable&quot; data is data held in Alchemy on a per-unit basis, which can be updated using the &quot;UpdateExportableData&quot; command. Upon pasting, Alchemy creates the unit then runs the &quot;import&quot; method providing the same &quot;exportable&quot; data that was collected before.</p><p>Alchemy only stipulates that this data is a string, meaning that any format can be used so long as it is representable in string form. The collection and encoding of this data and the updating of the Alchemy held &quot;exportable&quot; data is the responsibility of the unit&#x27;s designer, as is the correct decoding and distribution of this data.</p><p>The same &quot;Import/Export&quot; system is also used for saving/loading a project file.</p><h2>Let&#x27;s Do It</h2><p>All you have to do is modify the main.ts file to look like this</p><div class="style_main__GW_QM"><div class="style_codeSpace__m5Tgk style_codeSpace_limited__cJzT_"><div class="style_lineNumbers__S0NBN"><pre class="style_line__dmLdn">0</pre><pre class="style_line__dmLdn">1</pre><pre class="style_line__dmLdn">2</pre><pre class="style_line__dmLdn">3</pre><pre class="style_line__dmLdn">4</pre><pre class="style_line__dmLdn">5</pre><pre class="style_line__dmLdn">6</pre><pre class="style_line__dmLdn">7</pre><pre class="style_line__dmLdn">8</pre><pre class="style_line__dmLdn">9</pre><pre class="style_line__dmLdn">10</pre><pre class="style_line__dmLdn">11</pre><pre class="style_line__dmLdn">12</pre><pre class="style_line__dmLdn">13</pre><pre class="style_line__dmLdn">14</pre><pre class="style_line__dmLdn">15</pre><pre class="style_line__dmLdn">16</pre><pre class="style_line__dmLdn">17</pre><pre class="style_line__dmLdn">18</pre><pre class="style_line__dmLdn">19</pre><pre class="style_line__dmLdn">20</pre><pre class="style_line__dmLdn">21</pre><pre class="style_line__dmLdn">22</pre><pre class="style_line__dmLdn">23</pre><pre class="style_line__dmLdn">24</pre><pre class="style_line__dmLdn">25</pre><pre class="style_line__dmLdn">26</pre></div><div class="style_lines__PGiOP"><pre class="style_line__dmLdn style_dim__3BD2K">import apiConsole from &quot;../typescript-deno-0.3.3-0.1.0/index.ts&quot;;</pre><pre class="style_line__dmLdn style_dim__3BD2K"> </pre><pre class="style_line__dmLdn">let state = false;</pre><pre class="style_line__dmLdn"> </pre><pre class="style_line__dmLdn">function updateExportableData() {</pre><pre class="style_line__dmLdn">	apiConsole.unit.updateExportableData(</pre><pre class="style_line__dmLdn">		JSON.stringify(state)</pre><pre class="style_line__dmLdn">	);</pre><pre class="style_line__dmLdn">}</pre><pre class="style_line__dmLdn"> </pre><pre class="style_line__dmLdn">apiConsole.unit.setImportListener(({dataString}) =&gt; {</pre><pre class="style_line__dmLdn">	state = JSON.parse(dataString) as boolean;</pre><pre class="style_line__dmLdn">	apiConsole.interface.glowbox.onOff(0, true,  state);</pre><pre class="style_line__dmLdn">	if(state) {</pre><pre class="style_line__dmLdn">		apiConsole.interface.checkbox.check(1, true);</pre><pre class="style_line__dmLdn">	} else {</pre><pre class="style_line__dmLdn">		apiConsole.interface.checkbox.uncheck(1, true);</pre><pre class="style_line__dmLdn">	}</pre><pre class="style_line__dmLdn">});</pre><pre class="style_line__dmLdn"> </pre><pre class="style_line__dmLdn style_dim__3BD2K">apiConsole.unit.setMouseEventListener(({ event }) =&gt; {</pre><pre class="style_line__dmLdn style_dim__3BD2K">	if(event.type === &quot;checkbox&quot;) {</pre><pre class="style_line__dmLdn">		state = event.content === &quot;checked&quot;;</pre><pre class="style_line__dmLdn">		apiConsole.interface.glowbox.onOff(0, true,  state);</pre><pre class="style_line__dmLdn">		updateExportableData();</pre><pre class="style_line__dmLdn style_dim__3BD2K">	}</pre><pre class="style_line__dmLdn style_dim__3BD2K">});</pre></div></div></div><p>Its a pretty simple change, but lets step through it</p><div class="style_group__F7vT_"><p>Our code journey starts at line 2, where we define the state of the unit. In this case the unit is very simple, so the state only needs to hold a boolean value representing whether the light is on or off.</p><p>There are two actions that must be accounted for</p><ul><li><b>importing</b> - receiving a state from Alchemy</li><li><b>exporting</b> - sending a new state off to Alchemy to be stored</li></ul><p>Lets start with Exporting first</p><p>Lines 4 through 8 are where we define a function to handle the process of updating the Alchemy-stored state. We can see it calling the console&#x27;s unit-function &quot;updateExportableData&quot; and providing it with a Json stringified version of the boolean state we set up earlier.</p><p>The function is used on line 24, within the mouse event callback function, just after the state boolean and glowbox are set. This way, whenever the state of the unit is changed, the unit immediately updates the Alchemy-stored state.</p><p>Now for Importing</p><p>Lines 10 through 18 handle the importing. Here we see the listener for the import event &quot;setImportListener&quot; is given a callback, which takes &quot;dataString&quot; as an argument. This &quot;dataString&quot; is the very same Json stringified boolean we sent to Alchemy with the &quot;updateExportableData&quot;, so decoding it is just a simple case of running the Json &quot;parse&quot; command.</p><p>Once we have the state decoded, we simply update the boolean value, glowbox and checkbox.</p></div><h2>Done!</h2><p>Congratulations! You&#x27;ve gotten import and export working!</p><p>It really is that simple. Alchemy will store whatever string you give it, so you have total freedom to encode your data in whatever way you see fit.</p><p>In the next chapter, we&#x27;re going to look at Undo and Redo</p></div><div class="style_previousNext__Pea0Y"><a class="style_nextPreviousButton__BDi40 style_previousPage__i2BI3" href="/guide/developer/tutorials/article/how-to-make-a-unit/1">Previous</a><a class="style_nextPreviousButton__BDi40 style_nextPage__eSJ7i" href="/guide/developer/tutorials/article/how-to-make-a-unit/3">Next</a></div></div></div></main></div><footer class="style_main__NsKqp"><img src="/four_colour_stripes_banner.png" class="style_backgroundImage___DZ8F"/><div class="style_overlay__nf3f4"><p>© Metasophiea / Interloper 2024</p></div></footer></div><script src="/_next/static/chunks/webpack-beb2beff28c45430.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/120a5a1920781bd0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/b207df9cce6f5d60.css\",\"style\"]\n3:HL[\"/_next/static/css/518ba64fc6b7f185.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[992,[],\"\"]\n6:I[1001,[],\"ClientPageRoot\"]\n7:I[3325,[\"5555\",\"static/chunks/5555-7fa0558dbec5c878.js\",\"8860\",\"static/chunks/app/guide/developer/tutorials/article/how-to-make-a-unit/2/page-79e23c5a0efa9469.js\"],\"default\"]\n8:I[6882,[],\"\"]\n9:I[6126,[],\"\"]\na:I[5555,[\"5555\",\"static/chunks/5555-7fa0558dbec5c878.js\",\"7780\",\"static/chunks/app/guide/developer/page-8d425e553306cf8c.js\"],\"\"]\nb:I[6876,[\"5555\",\"static/chunks/5555-7fa0558dbec5c878.js\",\"3185\",\"static/chunks/app/layout-cb24b2dc0288066b.js\"],\"default\"]\nd:I[5999,[],\"\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b207df9cce6f5d60.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"k6vhSifRhdMuuk8ZpTNKF\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/guide/developer/tutorials/article/how-to-make-a-unit/2\",\"initialTree\":[\"\",{\"children\":[\"guide\",{\"children\":[\"developer\",{\"children\":[\"tutorials\",{\"children\":[\"article\",{\"children\":[\"how-to-make-a-unit\",{\"children\":[\"2\",{\"children\":[\"__PAGE__\",{}]}]}]}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"guide\",{\"children\":[\"developer\",{\"children\":[\"tutorials\",{\"children\":[\"article\",{\"children\":[\"how-to-make-a-unit\",{\"children\":[\"2\",{\"children\":[\"__PAGE__\",{},[[\"$L5\",[\"$\",\"$L6\",null,{\"props\":{\"params\":{},\"searchParams\":{}},\"Component\":\"$7\"}]],null],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"guide\",\"children\",\"developer\",\"children\",\"tutorials\",\"children\",\"article\",\"children\",\"how-to-make-a-unit\",\"children\",\"2\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/518ba64fc6b7f185.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"guide\",\"children\",\"developer\",\"children\",\"tutorials\",\"children\",\"article\",\"children\",\"how-to-make-a-unit\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"guide\",\"children\",\"developer\",\"children\",\"tutorials\",\"children\",\"article\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"guide\",\"children\",\"developer\",\"children\",\"tutorials\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"guide\",\"children\",\"developer\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"guide\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__className_c0d5fb\",\"children\":[\"$\",\"div\",null,{\"className\":\"style_main__l8Il9\",\"children\":[[\"$\",\"div\",null,{\"children\":[[[\"$\",\"div\",null,{\"className\":\"style_desktop__CvcZU\",\"children\":[\"$\",\"div\",null,{\"className\":\"style_main__JqgJs\",\"children\":[[\"$\",\"div\",null,{\"className\":\"style_logo___Nv4Y\",\"children\":[\"$\",\"$La\",null,{\"href\":\"/\",\"className\":\"style_logoLink__8L3yx\",\"children\":[\"$\",\"img\",null,{\"src\":\"/icon.png\",\"className\":\"style_logoImage__PktfC\"}]}]}],[\"$\",\"div\",null,{\"className\":\"style_links__h4_vb\",\"children\":[[[\"$\",\"div\",\"link-0\",{\"className\":\"style_linkAndSub__7qTZ1\",\"children\":[[\"$\",\"$La\",null,{\"href\":\"/news\",\"className\":\"style_link__4XuJC\",\"children\":\"News\"}],\"$undefined\"]}],[\"$\",\"div\",\"link-1\",{\"className\":\"style_linkAndSub__7qTZ1\",\"children\":[[\"$\",\"$La\",null,{\"href\":\"/guide\",\"className\":\"style_link__4XuJC\",\"children\":\"Guide\"}],[\"$\",\"div\",null,{\"className\":\"style_sub__vF1DF\",\"children\":[[\"$\",\"div\",\"link-1-sublink-0\",{\"className\":\"style_linkAndSub__7qTZ1\",\"children\":[\"$\",\"$La\",null,{\"href\":\"/guide/getting-started\",\"className\":\"style_link__4XuJC\",\"children\":\"Getting Started\"}]}],[\"$\",\"div\",\"link-1-sublink-1\",{\"className\":\"style_linkAndSub__7qTZ1\",\"children\":[\"$\",\"$La\",null,{\"href\":\"/guide/units\",\"className\":\"style_link__4XuJC\",\"children\":\"Units\"}]}],[\"$\",\"div\",\"link-1-sublink-2\",{\"className\":\"style_linkAndSub__7qTZ1\",\"children\":[\"$\",\"$La\",null,{\"href\":\"/guide/developer\",\"className\":\"style_link__4XuJC\",\"children\":\"Developer\"}]}]]}]]}]],[\"$\",\"$La\",null,{\"href\":\"/download\",\"className\":\"style_download__caECe\",\"children\":\"Download\"}]]}]]}]}],[\"$\",\"div\",null,{\"className\":\"style_mobile__mRKt2\",\"children\":[\"$\",\"$Lb\",null,{}]}]],[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]]}],[\"$\",\"footer\",null,{\"className\":\"style_main__NsKqp\",\"children\":[[\"$\",\"img\",null,{\"src\":\"/four_colour_stripes_banner.png\",\"className\":\"style_backgroundImage___DZ8F\"}],[\"$\",\"div\",null,{\"className\":\"style_overlay__nf3f4\",\"children\":[\"$\",\"p\",null,{\"children\":\"© Metasophiea / Interloper 2024\"}]}]]}]]}]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Alchemy\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"A Virtual Studio\"}],[\"$\",\"meta\",\"4\",{\"name\":\"next-size-adjust\"}]]\n5:null\n"])</script></body></html>